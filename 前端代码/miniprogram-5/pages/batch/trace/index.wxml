<view class="page-container">
    <view class="header">
        <view class="title">æ‰¹æ¬¡æº¯æºå›¾è°±</view>
        <view class="desc">å½“å‰èŠ‚ç‚¹ï¼š{{currentBatchNo}}</view>
    </view>
    <view class="tree-container">
        <!-- Root Node -->
        <view class="node-wrapper">
            <view class="node root">
                <view class="node-content">
                    <view class="node-title">{{rootBatch.name || 'æœªçŸ¥åç§°'}}</view>
                    <view class="node-sub">{{rootBatch.batchNo}}</view>
                    <view class="tag success">{{rootBatch.status}}</view>
                </view>
            </view>
            <!-- Recursive Children -->
            <view class="children" wx:if="{{tree && tree.length > 0}}">
                <view class="connector-v"></view>
                <block wx:for="{{tree}}" wx:key="childBatchNo">
                    <view class="child-branch">
                        <view class="connector-h"></view>
                        <view class="node child" bindtap="traceChild" data-batch="{{item.childBatchNo}}">
                            <view class="node-content">
                                <view class="process-tag">{{item.processType || 'åŠ å·¥'}}</view>
                                <view class="node-title">
                                    {{item.childName}}
                                    <text style="float:right; color:#999;">â†’</text>
                                </view>
                                <view class="node-sub" catchtap="copy" data-text="{{item.childBatchNo}}">
                                    {{item.childBatchNo}}
                                    <text class="icon-copy">ğŸ“„</text>
                                </view>
                                <view class="node-desc">{{item.details || 'æ— è¯¦æƒ…'}}</view>
                            </view>
                        </view>
                        <!-- Support deeper levels if needed, for now 1 level deep demo -->
                    </view>
                </block>
            </view>
            <view class="empty-tree" wx:else>æš‚æ— åç»­åŠ å·¥è®°å½•</view>
        </view>
    </view>
</view>