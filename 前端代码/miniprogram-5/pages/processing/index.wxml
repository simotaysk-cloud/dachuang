<view class="page-container">
    <view class="header">
        <view class="title">加工处理</view>
        <view class="desc">记录药材的烘干、切片、包装等工厂环节</view>
    </view>
    <view class="card">
        <view class="section-title">加工登记</view>
        <input class="input" placeholder="记录ID（编辑用）" value="{{form.id}}" data-field="id" bindinput="onInput" />
        <input class="input" placeholder="上游/原料批次号 (parentBatchNo)" value="{{form.parentBatchNo}}" data-field="parentBatchNo" bindinput="onInput" />
        <input class="input" placeholder="产出批次号 (batchNo，可空自动生成)" value="{{form.batchNo}}" data-field="batchNo" bindinput="onInput" />
        <input class="input" placeholder="加工工艺 (processType)" value="{{form.processType}}" data-field="processType" bindinput="onInput" />
        <input class="input" placeholder="工厂名称 (factory)" value="{{form.factory}}" data-field="factory" bindinput="onInput" />
        <input class="input" placeholder="操作人 (operator)" value="{{form.operator}}" data-field="operator" bindinput="onInput" />
        <view class="section-title" style="margin-top:20rpx">加工现场</view>
        <input class="input" placeholder="现场照片 (imageUrl)" value="{{form.imageUrl}}" data-field="imageUrl" bindinput="onInput" />
        <textarea class="textarea" placeholder="详细说明 (details)" value="{{form.details}}" data-field="details" bindinput="onInput" />
        <view class="btn-group">
            <button class="btn btn-primary" bindtap="save">保存记录</button>
            <button class="btn btn-warn" bindtap="remove">删除记录</button>
        </view>
    </view>
    <view class="card">
        <view class="section-title">历史查询</view>
        <view class="search-bar">
            <input class="input-inline" placeholder="输入 batchNo" value="{{queryNo}}" bindinput="onQueryInput" />
            <button class="btn-small" bindtap="query">查询</button>
        </view>
        <view class="search-bar">
            <input class="input-inline" placeholder="输入 parentBatchNo" value="{{parentQueryNo}}" bindinput="onParentQueryInput" />
            <button class="btn-small" bindtap="queryByParent">查上游</button>
        </view>
    </view>
    <view class="result-area" wx:if="{{result}}">
        <scroll-view scroll-y class="result-scroll">
            <text class="result-text">{{result}}</text>
        </scroll-view>
    </view>
</view>
