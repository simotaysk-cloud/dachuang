<view class="page-container">
    <view class="header">
        <view class="title">加工处理</view>
        <view class="desc">记录药材的烘干、切片、包装等工厂环节</view>
    </view>
    <!-- 筛选与操作 -->
    <view class="card">
        <view class="section-title">加工记录列表</view>
        <view class="search-bar">
            <input class="input-inline" placeholder="输入产出批次号查询" value="{{queryNo}}" bindinput="onQueryInput" />
            <button class="btn-small" bindtap="query">查询</button>
        </view>
        <view class="btn-group" style="flex-direction: column; margin-bottom: 20rpx;">
            <button class="btn btn-primary" bindtap="onScanStart">扫码开工（产线模式）</button>
            <button class="btn btn-outline" bindtap="startCreate">普通增补记录</button>
        </view>
        <!-- 列表内容 -->
        <view class="list" wx:if="{{records && records.length > 0}}">
            <view class="list-item" wx:for="{{records}}" wx:key="id" bindtap="editFromList" data-item="{{item}}">
                <view class="list-main">
                    <view class="list-title">
                        {{item.processType || '未命名工艺'}}
                        <text style="font-size:24rpx; color:#999;">#{{item.id}}</text>
                    </view>
                    <view class="list-sub">
                        原料: {{item.parentBatchNo}}
                        <text wx:if="{{item.batchNo}}">➡ 产出: {{item.batchNo}}</text>
                    </view>
                    <view class="list-meta">
                        工厂: {{item.factory || '-'}} · 操作人: {{item.operator || '-'}}
                    </view>
                </view>
                <view class="list-action">详情</view>
            </view>
        </view>
        <view class="empty" wx:if="{{(!records || records.length === 0) && !loading}}">暂无记录</view>
    </view>
</view>
