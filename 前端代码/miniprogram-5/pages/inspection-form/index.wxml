<view class="page-container">
    <view class="header">
        <view class="title">{{id ? '质检记录详情' : '质检录入'}}</view>
        <view class="desc">{{id ? '查看或修正质检信息' : '提交后将生成新批次并生成新二维码'}}</view>
    </view>

        <view class="card" wx:if="{{!id}}">
            <view class="section-title">质检信息</view>
            <view class="field-label">被检批次号</view>
        <input class="input {{parentLocked ? 'input-locked' : ''}}" placeholder="扫码或手工输入上游批次号" value="{{createForm.parentBatchNo}}" data-field="parentBatchNo" bindinput="onCreateInput" disabled="{{parentLocked}}" />

        <view class="field-label">检测结果</view>
        <input class="input" placeholder="例如：合格 / 优级 / 不合格" value="{{createForm.result}}" data-field="result" bindinput="onCreateInput" />

        <view class="field-label">报告链接（可选）</view>
        <input class="input" placeholder="PDF/图片 URL" value="{{createForm.reportUrl}}" data-field="reportUrl" bindinput="onCreateInput" />

        <view class="field-label">质检员</view>
        <input class="input" placeholder="姓名" value="{{createForm.inspector}}" data-field="inspector" bindinput="onCreateInput" />

        <view class="field-label">备注说明（可选）</view>
        <textarea class="textarea" placeholder="备注信息..." value="{{createForm.details}}" data-field="details" bindinput="onCreateInput" />

        <view class="btn-group">
            <button class="btn btn-primary" bindtap="submitAndGenQr">提交并生成二维码</button>
            <button class="btn btn-outline" bindtap="cancel">返回</button>
        </view>
    </view>

    <view class="card" wx:if="{{id}}">
        <view class="section-title">记录信息</view>
        <view class="readonly-row">
            <view class="readonly-label">记录ID</view>
            <view class="readonly-value">#{{record.id}}</view>
        </view>
        <view class="readonly-row">
            <view class="readonly-label">批次号</view>
            <view class="readonly-value">{{record.batchNo}}</view>
        </view>

        <view class="field-label">检测结果</view>
        <input class="input" placeholder="例如：合格 / 优级 / 不合格" value="{{record.result}}" data-field="result" bindinput="onRecordInput" />

        <view class="field-label">报告链接（可选）</view>
        <input class="input" placeholder="PDF/图片 URL" value="{{record.reportUrl}}" data-field="reportUrl" bindinput="onRecordInput" />

        <view class="field-label">质检员</view>
        <input class="input" placeholder="姓名" value="{{record.inspector}}" data-field="inspector" bindinput="onRecordInput" />

        <view class="btn-group">
            <button class="btn btn-primary" bindtap="viewQr">查看二维码</button>
            <button class="btn btn-outline" bindtap="saveRecord">保存修改</button>
        </view>
        <button class="btn btn-warn" style="margin-top:20rpx;" bindtap="revokeRecord">撤回记录</button>
        <button class="btn btn-outline" style="margin-top:20rpx;" bindtap="cancel">返回</button>
    </view>
</view>
